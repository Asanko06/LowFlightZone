## Диаграмма вариантов использования

## Глоссарий

|Термин	                |Определение|
|:----------------------|:---------------------------------------------|
|Гость                  | Неаутентифицированный пользователь веб-приложения. Для продолжения работы необходимо аутентифицироваться.|
|Пользователь           | Аутентифицированный зарегистрированный пользователь приложения. Может подписываться на рейсы, управлять подписками, получать уведомления и рекомендации. |
|Администратор          | Привилегированный пользователь с правами на техническое управление системой.|              
|Рейс       | Авиаперелёт с номером, статусом, временем вылета/прилёта и аэропортами отправления и прибытия.|
|Подписка на рейс       |	Персонализированная запись пользователя, позволяющая получать уведомления о статусе конкретного рейса.|
|Рекомендация по выезду |	Предлагаемое системой оптимальное время отправления в аэропорт на основе статуса рейса, пробок и местоположения пользователя.|

##Поток событий

##Содержание

- [1 Актеры](#1-актеры)
- [2 Варианты использования](#2-варианты-использования)
- [2.1 Зарегистрироваться](#21-Зарегистрироваться)

- [2.2 Войти в учетную запись](#22-Войти-в-учетную-запись)

- [2.3 Найти и просмотреть рейс](#23-Найти-и-просмотреть-рейс)

- [2.4 Управлять подписками на рейсы](#24-Управлять-подписками-на-рейсы)

- [2.5 Получить push-уведомления об изменении статуса рейса](#25-Получить-push-уведомления-об-изменении-статуса-рейса)

- [2.6 Получить рекомендацию по времени выезда](#26-Получить-рекомендацию-по-времени-выезда)

- [2.7 Просмотреть историю подписок](#27-Просмотреть-историю-подписок)

- [2.8 Выйти из учетной записи](#28-Выйти-из-учетной-записи)

- [2.9 Управление интеграциями и конфигурацией системы (администратор)](#29-Управление-интеграциями-и-конфигурацией-системы (администратор))

##1 Актеры
|Актер	       |Описание|
|:-------------|:-------------------------------------------------|
|Гость	       |Неаутентифицированный пользователь веб-приложения. Для продолжения работы необходимо аутентифицироваться.|
|Пользователь  |	Аутентифицированный пользователь. Наследует возможности Гостя. Может подписываться на рейсы, управлять подписками, получать уведомления и рекомендации, просматривать историю своих подписок.|
|Администратор |	Привилегированный пользователь. Наследует возможности Пользователя. Отвечает за управление интеграциями с внешними API и конфигурацией системы. В текущей версии не взаимодействует с UI напрямую.|

##2 Варианты использования
##2.1 Зарегистрироваться

**Описание**. Вариант использования "Зарегистрироваться" позволяет Гостю создать новую учётную запись в системе.

**Предусловия.** Гость находится на странице аутентификации и выбрал опцию "Регистрация".

**Основной поток.**

- Система отображает форму регистрации, запрашивая email и пароль.
- Гость вводит требуемые данные и подтверждает отправку формы.
- Система проверяет валидность email и соответствие пароля политике безопасности.
- Система создаёт новую учётную запись, хэширует пароль и автоматически аутентифицирует пользователя.
- Система перенаправляет Пользователя на главную страницу.
- Вариант использования завершается.
Альтернативный поток А1: Данные невалидны.
- Если введённые данные не проходят проверку (email не уникален, пароль слишком простой), система отображает соответствующее сообщение об ошибке.
- Возврат к п.2 основного потока.
Альтернативный поток А2: Отмена регистрации.
- Гость отменяет процесс регистрации до подтверждения.
- Система возвращает Гостя на страницу аутентификации.
- Вариант использования завершается досрочно.

**Постусловия.** Гость получает статус "Пользователь" и аутентифицирован в системе.

##2.2 Войти в учетную запись

**Описание.** Вариант использования "Войти в учетную запись" позволяет зарегистрированному пользователю аутентифицироваться в системе.

**Предусловия.** Пользователь находится на странице аутентификации.

**Основной поток.**
- Пользователь вводит свой email и пароль в форму входа.
- Пользователь подтверждает отправку формы.
- Система проверяет соответствие введённого пароля хэшу в базе данных.
- При успешной проверке система создаёт сессию (JWT-токен) и перенаправляет Пользователя на главную страницу.
- Вариант использования завершается.
Альтернативный поток А1: Неверные учётные данные.
- Если email или пароль неверны, система отображает сообщение об ошибке аутентификации.
- Возврат к п.1 основного потока.

**Постусловия.** Пользователь аутентифицирован в системе.

##2.3 Найти и просмотреть рейс
**Описание.** Вариант использования позволяет Гостю или Пользователю найти и просмотреть статус рейса по номеру.

**Предусловия.** Актёр находится в приложении.

**Основной поток.**
- Актёр вводит номер рейса в поле поиска.
- Система обращается к внешним API и получает актуальную информацию.
- Система отображает статус рейса, время вылета и прилёта, прогнозируемые задержки, гейт и другую доступную информацию.
- Вариант использования завершается.
Альтернативный поток А1: Рейс не найден.
- Система уведомляет пользователя о том, что рейс не найден, и предлагает проверить введённый номер.

##2.4 Управлять подписками на рейсы
**Описание.** Вариант использования позволяет Пользователю подписаться на рейс и управлять своими подписками.

**Предусловия.** Пользователь аутентифицирован.

**Основной поток.**
- Пользователь вводит номер рейса и нажимает "Подписаться".
- Система проверяет существование рейса и добавляет его в список "Мои рейсы".
- Пользователь может просматривать все активные подписки и их статусы.
- Пользователь может удалить любую подписку.
- Вариант использования завершается.
Альтернативный поток А1: Рейс не найден.
- Система уведомляет, что рейс не существует.
Альтернативный поток А2: Подписка уже существует.
- Система уведомляет пользователя, что он уже подписан на этот рейс.
- Постусловия. Подписка создаётся или обновляется, уведомления активируются.

##2.5 Получить push-уведомления об изменении статуса рейса
**Описание.** Система отправляет уведомления пользователю о критических изменениях подписанных рейсов.

**Предусловия.** Пользователь подписан на рейс и дал разрешение на получение уведомлений.

**Основной поток.**
- Система отслеживает изменения статуса рейса через внешние API.
- При изменении статуса система отправляет push-уведомление (например: "Рейс задержан", "Рейс отменён").
- Пользователь получает уведомление и может открыть страницу рейса.
- Вариант использования завершается.
Альтернативный поток А1: Push-уведомления отключены.
- Пользователь не получает уведомления.

##2.6 Получить рекомендацию по времени выезда
**Описание.** Вариант использования позволяет Пользователю рассчитать оптимальное время выезда в аэропорт.

**Предусловия.** Пользователь аутентифицирован и предоставил разрешение на использование геолокации.

**Основной поток.**
- Пользователь открывает страницу "Рекомендации".
- Система определяет текущее местоположение и данные о рейсе.
- Система анализирует пробки, время регистрации, прогноз задержек и загруженность терминала.
- Система рассчитывает и отображает оптимальное время выезда и предполагаемое время прибытия.
- Вариант использования завершается.
Альтернативный поток А1: Геолокация недоступна.Система предлагает пользователю ввести адрес вручную.

##2.7 Просмотреть историю подписок
**Описание.** Вариант использования позволяет Пользователю просмотреть историю подписок и уведомлений.

**Предусловия.** Пользователь аутентифицирован.

**Основной поток.**
- Пользователь открывает свой профиль.
- Система отображает историю подписок и уведомлений с фильтрацией по дате, статусу и аэропорту.
- Вариант использования завершается.

##2.8 Выйти из учетной записи
**Описание.** Вариант использования позволяет Пользователю завершить сеанс работы в системе.

**Предусловия.** Пользователь аутентифицирован.

**Основной поток.**
- Пользователь нажимает кнопку "Выход" в интерфейсе приложения.
- Система инвалидирует JWT-токен пользователя.
- Система перенаправляет пользователя на страницу аутентификации.
- Вариант использования завершается.

##2.9 Управление интеграциями и конфигурацией системы (администратор)
**Описание.** Вариант использования позволяет Администратору управлять конфигурацией системы и подключениями к внешним API.

**Предусловия.** Пользователь аутентифицирован и имеет роль "Администратор".

**Основной поток.**
- Администратор открывает панель управления.
- Система отображает список активных интеграций и их состояние.
- Администратор обновляет ключи API, включает/отключает интеграции или просматривает журнал ошибок.
- Система сохраняет изменения и применяет их.
- Вариант использования завершается.



